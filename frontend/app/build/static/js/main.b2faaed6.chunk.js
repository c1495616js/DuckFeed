(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{395:function(e,t,a){e.exports=a(660)},400:function(e,t,a){},660:function(e,t,a){"use strict";a.r(t);var n=a(19),r=a(20),l=a(22),o=a(21),c=a(23),i=a(0),s=a.n(i),u=a(104),m=a.n(u),d=a(177),h=(a(400),a(30)),p=a(241),f=a(280),g=a(115),E=a(312),b=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={user:a.props.currentUser},a.dropdownOptions=function(){return[{key:"user",text:s.a.createElement("span",null,"Signed in as ",s.a.createElement("strong",null,a.state.user.name)),disabled:!0},{key:"signout",text:s.a.createElement("p",{onClick:a.handleSignout},"Sign Out")}]},a.handleSignout=function(){localStorage.setItem("ACCESS_TOKEN",""),window.location.reload()},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state.user;return s.a.createElement("div",null,s.a.createElement(d.a,{style:{background:"#4c3c4c"}},s.a.createElement(d.a.Column,null,s.a.createElement(d.a.Row,{style:{padding:"1.2em",margin:0}},s.a.createElement(f.a,{inverted:!0,floated:"left",as:"h2"},s.a.createElement(g.a,{name:"paw"}),s.a.createElement(f.a.Content,null,"DuckFeed"))),s.a.createElement(f.a,{style:{padding:"0.25em"},as:"h4",inverted:!0},s.a.createElement(E.a,{trigger:s.a.createElement("span",null,e.name),options:this.dropdownOptions()})))))}}]),t}(i.Component),v=a(61),y=a(37),k=function(e){return{type:"DO_SEARCH",payload:{currentSearch:e}}},C=a(28),O=a.n(C),S=a(268),j=a.n(S),w=j.a;w=j.a.create({baseURL:"duckfeed.c1495616.com:8000/index.php/"}),localStorage.getItem("ACCESS_TOKEN")&&(w.defaults.headers.common.Authorization=localStorage.getItem("ACCESS_TOKEN"));var _=w,D=a(29),N=a.n(D),A=a(323),F=a(343),P=a(164),R=a(344),I=a(246),T=a(340),U=a(345),x=a(239),M=a(370),W={park:"",time:O()().format("DD/MM/YYYY HH:mm"),numbers:1,name:"",kind:"",amount:0,is_regular:0},H=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state=Object(y.a)({user:a.props.currentUser,feeds:[]},Object.assign({},W),{modal:!1,errors:[],loading:!1}),a.fetchMyFeeds=function(){_.post("feed/list_feed",N.a.stringify({page_disabled:!0,user_id:a.state.user.id})).then(function(e){return e.data}).then(function(e){var t=e.list;"Authorization Error"!==e.error_code&&(console.log("list:",t),a.setState({feeds:t}))}).catch(function(e){console.error(e)})},a.addFeed=function(){var e=a.state,t=e.park,n=e.time,r=e.numbers,l=e.name,o=e.kind,c=e.amount,i=e.user,s=e.is_regular,u={park:t.toLowerCase(),time:O()(n,"DD/MM/YYYY HH:mm").format("YYYY-MM-DD HH:mm"),numbers:r,name:l.toLowerCase(),kind:o.toLowerCase(),amount:c,user_id:i.id,is_regular:s};_.post("feed/add_feed",N.a.stringify(u)).then(function(){a.setState(Object(y.a)({},Object.assign({},W),{loading:!1}),function(){a.fetchMyFeeds(),a.props.doSearch([])}),a.closeModal(),console.log("feed added")}).catch(function(e){console.error(e),a.setState({loading:!1})})},a.handleSubmit=function(e){e.preventDefault(),a.isFormValid()&&(a.setState({errors:[],loading:!0}),a.addFeed())},a.isFormValid=function(){var e,t=[];return a.isFormEmpty(a.state)?(e={message:"Fill in all fields"},a.setState({errors:t.concat(e)}),!1):!!a.isAmountValid(a.state)||(e={message:"Amount is float number and greater than zero"},void a.setState({errors:t.concat(e)}))},a.isFormEmpty=function(e){var t=e.park,a=e.time,n=e.name,r=e.kind,l=e.amount;return!t.length||!a.length||!n.length||!r.length||!l.length},a.isAmountValid=function(e){var t=e.amount;return!isNaN(t)&&t>0},a.displayErrors=function(e){return e.map(function(e,t){return s.a.createElement("p",{key:t},e.message)})},a.handleChange=function(e,t){t&&"is_regular"===t.name&&a.setState({is_regular:t.checked?1:0}),a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleTimeChange=function(e,t){var n=t.name,r=t.value;a.state.hasOwnProperty(n)&&a.setState(Object(v.a)({},n,r))},a.handleInputError=function(e,t){return e.some(function(e){return e.message.toLowerCase().includes(t)})?"error":""},a.opneModal=function(){a.setState({modal:!0})},a.closeModal=function(){a.setState({modal:!1})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchMyFeeds()}},{key:"render",value:function(){var e=this.state,t=e.feeds,a=e.modal,n=e.errors,r=e.loading;return s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a.Menu,{style:{paddingBottom:"2em"}},s.a.createElement(p.a.Item,null,s.a.createElement("span",null,s.a.createElement(g.a,{name:"cloud upload"})," Feeds")," ","(",t.length,") ",s.a.createElement(g.a,{name:"add",onClick:this.opneModal}))),s.a.createElement(A.a,{basic:!0,open:a,onClose:this.closeModal},s.a.createElement(A.a.Header,null,s.a.createElement(g.a,{name:"paw"})," Add Feed"),s.a.createElement(A.a.Content,null,s.a.createElement(F.a,{onSubmit:this.handleSubmit},s.a.createElement("div",{style:{margin:"15px 0"}},s.a.createElement(P.a,{color:"teal",tag:!0},s.a.createElement(g.a,{name:"book"}),s.a.createElement("span",null,"Basic Information"))),s.a.createElement(F.a.Field,null,s.a.createElement(R.a,{fluid:!0,label:"Park Name",name:"park",value:this.state.park,className:this.handleInputError(n,"park"),onChange:this.handleChange})),s.a.createElement(F.a.Field,null,s.a.createElement(M.DateTimeInput,{name:"time",placeholder:"Date Time",value:this.state.time,iconPosition:"left",closeOnMouseLeave:!1,onChange:this.handleTimeChange})),s.a.createElement(F.a.Field,null,s.a.createElement(R.a,{fluid:!0,type:"number",label:"Numbers",name:"numbers",value:this.state.numbers,onChange:this.handleChange,min:"1"})),s.a.createElement(F.a.Field,null,s.a.createElement(I.a,null,s.a.createElement(T.a,{label:"Is Repeating",name:"is_regular",onChange:this.handleChange}))),s.a.createElement("div",{style:{margin:"15px 0"}},s.a.createElement(P.a,{color:"red",tag:!0},s.a.createElement(g.a,{name:"food"}),s.a.createElement("span",null,"Food Information"))),s.a.createElement(F.a.Field,null,s.a.createElement(R.a,{fluid:!0,label:"Food Name",name:"name",value:this.state.name,onChange:this.handleChange})),s.a.createElement(F.a.Field,null,s.a.createElement(R.a,{fluid:!0,label:"Food Kind",name:"kind",value:this.state.kind,onChange:this.handleChange})),s.a.createElement(F.a.Field,null,s.a.createElement(R.a,{fluid:!0,label:"Food Amount (kg)",name:"amount",value:this.state.amount,onChange:this.handleChange}))),n.length>0&&s.a.createElement(U.a,{error:!0},s.a.createElement("h3",null,"Error"),this.displayErrors(n))),s.a.createElement(A.a.Actions,null,s.a.createElement(x.a,{color:"green",inverted:!0,onClick:this.handleSubmit,disabled:r,className:r?"loading":""},s.a.createElement(g.a,{name:"checkmark"})," Add"),s.a.createElement(x.a,{color:"red",inverted:!0,onClick:this.closeModal},s.a.createElement(g.a,{name:"remove"})," Cancel"))))}}]),t}(i.Component),B=Object(h.b)(null,{doSearch:k})(H),J=a(346),L=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={data:null},a.fetchData=function(){_.post("feed/list_feed",N.a.stringify({contribution:!0})).then(function(e){return e.data}).then(function(e){var t=e.list;a.setState({data:t})}).catch(function(e){console.error(e)})},a.displayTableCell=function(){var e=a.state.data,t=a.props.currentUser;return e?e.map(function(e,a){return s.a.createElement(J.a.Row,{key:e.id},s.a.createElement(J.a.Cell,{textAlign:"center"},s.a.createElement("p",{className:t.id===e.user_id?"ownContribution":""},a+1)),s.a.createElement(J.a.Cell,null,s.a.createElement("p",{className:t.id===e.user_id?"ownContribution":""},e.user_name)),s.a.createElement(J.a.Cell,{textAlign:"center"},s.a.createElement("p",{className:t.id===e.user_id?"ownContribution":""},e.total_cnt)))}):s.a.createElement(J.a.Row,null,s.a.createElement(J.a.Cell,{colSpan:"2"},"Proccessing..."))},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){var t=e.search;Array.isArray(t)&&0===t.length&&this.fetchData()}},{key:"render",value:function(){return s.a.createElement("div",{className:"contribution"},s.a.createElement("h4",null,"Rank of Contribution"),s.a.createElement(J.a,{basic:"very",celled:!0,collapsing:!0,color:"blue"},s.a.createElement(J.a.Header,null,s.a.createElement(J.a.Row,null,s.a.createElement(J.a.HeaderCell,null,"Rank"),s.a.createElement(J.a.HeaderCell,null,"User"),s.a.createElement(J.a.HeaderCell,null,"Contribute"))),s.a.createElement(J.a.Body,null,this.displayTableCell())))}}]),t}(i.Component),Y=Object(h.b)(function(e){return e.search.currentSearch?{search:e.search.currentSearch}:{search:[]}})(L),K=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.currentUser;return s.a.createElement(p.a,{size:"large",inverted:!0,fixed:"left",vertical:!0,style:{background:"#4c3c4c",fontSize:"1.2rem"}},s.a.createElement(b,{currentUser:e}),s.a.createElement(B,{currentUser:e}),s.a.createElement(Y,{currentUser:e}))}}]),t}(i.Component),z=a(304),V=a(347),q=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={data:null,page:0,pages:1,p:{}},a.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_.post("feed/list_feed",N.a.stringify(Object(y.a)({},e,{page:a.state.page,need_pages:!0}))).then(function(e){return e.data}).then(function(e){var t=e.list,n=e.pages;a.setState({data:t,pages:n})})},a.renewData=function(){a.setState({data:null},function(){return a.fetchData(a.state.p)})},a.displayTableBody=function(){var e=a.state.data;return e?e.map(function(e){return s.a.createElement(J.a.Row,{key:e.id},s.a.createElement(J.a.Cell,null,e.park),s.a.createElement(J.a.Cell,null,e.time),s.a.createElement(J.a.Cell,{textAlign:"right"},e.numbers),s.a.createElement(J.a.Cell,null,"1"===e.is_regular?"Yes":"No"),s.a.createElement(J.a.Cell,{textAlign:"center"},e.name),s.a.createElement(J.a.Cell,{textAlign:"center"},e.kind),s.a.createElement(J.a.Cell,{textAlign:"center"},e.amount))}):s.a.createElement(J.a.Row,null,s.a.createElement(J.a.Cell,{colSpan:"7"},s.a.createElement(I.a,null,s.a.createElement(z.a,{active:!0},s.a.createElement(V.a,{size:"mini"})))))},a.displayPages=function(){var e=a.state,t=e.page,n=e.pages;return n<=7?Array(n).fill(0).map(function(e,n){return s.a.createElement(p.a.Item,{as:"a",key:n,className:n===t?"currentPage":"",onClick:function(){return a.changePage(n)}},n+1)}):t<=3?[1,2,3,4,5,"...",n].map(function(e,n){return s.a.createElement(p.a.Item,{as:"a",key:n,className:e-1===t?"currentPage":"..."===e?"pageDisabled":"",onClick:function(){return a.changePage(e-1)}},e)}):t>=n-4?[1,"...",n-4,n-3,n-2,n-1,n].map(function(e,n){return s.a.createElement(p.a.Item,{as:"a",key:n,className:e-1===t?"currentPage":"..."===e?"pageDisabled":"",onClick:function(){return a.changePage(e-1)}},e)}):[1,"...",t+1,t+2,t+3,"...",n].map(function(e,n){return s.a.createElement(p.a.Item,{as:"a",key:n,className:e-1===t?"currentPage":"..."===e?"pageDisabled":"",onClick:function(){return a.changePage(e-1)}},e)})},a.changePage=function(e){isNaN(e)||e<0||e>=a.state.pages||a.setState({page:e},a.renewData)},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){var t=this,a=e.search,n={search_park:JSON.stringify(a.park),search_food:JSON.stringify(a.name),search_kind:JSON.stringify(a.kind)};this.setState({p:n,page:0},function(){return t.fetchData(n)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.page,n=t.pages;return s.a.createElement("div",{className:"dataTable"},s.a.createElement(I.a,null,s.a.createElement("h1",null,"Data Table"),s.a.createElement(J.a,{celled:!0,structured:!0},s.a.createElement(J.a.Header,null,s.a.createElement(J.a.Row,null,s.a.createElement(J.a.HeaderCell,{rowSpan:"2"},"Where"),s.a.createElement(J.a.HeaderCell,{rowSpan:"2"},"Time"),s.a.createElement(J.a.HeaderCell,{rowSpan:"2"},"Numbers"),s.a.createElement(J.a.HeaderCell,{rowSpan:"2"},"Repeating"),s.a.createElement(J.a.HeaderCell,{colSpan:"3"},"Food")),s.a.createElement(J.a.Row,null,s.a.createElement(J.a.HeaderCell,null,"Name"),s.a.createElement(J.a.HeaderCell,null,"Kind"),s.a.createElement(J.a.HeaderCell,null,"Amount (kg)"))),s.a.createElement(J.a.Body,null,this.displayTableBody()),s.a.createElement(J.a.Footer,null,s.a.createElement(J.a.Row,null,s.a.createElement(J.a.HeaderCell,{colSpan:"7"},s.a.createElement(p.a,{floated:"right",pagination:!0},s.a.createElement(p.a.Item,{as:"a",icon:!0,className:0===a?"pageDisabled":"",onClick:function(){return e.changePage(a-1)}},s.a.createElement(g.a,{name:"chevron left"})),this.displayPages(),s.a.createElement(p.a.Item,{as:"a",icon:!0,className:a===n-1?"pageDisabled":"",onClick:function(){return e.changePage(a+1)}},s.a.createElement(g.a,{name:"chevron right"})))))))))}}]),t}(i.Component),X=Object(h.b)(function(e){return e.search.currentSearch?{search:e.search.currentSearch}:{search:[]}})(q),$=a(78),G=window,Q=document,Z=Q.documentElement,ee=Q.getElementsByTagName("body")[0],te=G.innerWidth||Z.clientWidth||ee.clientWidth,ae=function(e){return e.map(function(e){return{x:parseFloat(O()(e.time).format("HH"))+parseFloat(O()(e.time).format("mm"))/60,y:e.numbers,size:e.amount,color:10*Math.random(),opacity:.5*Math.random()+.5,Park:e.park,Date:O()(e.time).format("DD/MM/YYYY"),Time:O()(e.time).format("HH:mm"),Numbers:e.numbers,Food:e.name,Kind:e.kind,Amount:"".concat(e.amount," kg")}})},ne={typeA:["#59E4EC","#0D676C"],typeB:["#EFC1E3","#B52F93"]},re=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={drawMode:0,data:[],colorType:"typeA",value:!1},a.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_.post("feed/list_feed",N.a.stringify(Object(y.a)({},e,{page_disabled:!0}))).then(function(e){return e.data}).then(function(e){var t=e.list;t.length>0?a.setState({data:ae(t)}):a.setState({data:[]})}).catch(function(e){console.error(e)})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){var t=e.search,a={search_park:JSON.stringify(t.park),search_food:JSON.stringify(t.name),search_kind:JSON.stringify(t.kind)};this.fetchData(a)}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.colorType,r={animation:!0,className:"mark-series-example",sizeRange:[5,15],seriesId:"my-example-scatterplot",colorRange:ne[n],opacityType:"literal",data:a,onNearestXY:function(t){e.setState({value:{Park:t.Park,Date:t.Date,Time:t.Time,Numbers:t.Numbers,Food:t.Food,Kind:t.Kind,Amount:t.Amount,x:t.x,y:t.y}})}};return s.a.createElement("div",null,s.a.createElement("h2",null,"Data Points"),s.a.createElement("p",null,s.a.createElement("strong",{style:{color:"blue"}},"X-axis"),": Time(hour)"),s.a.createElement("p",null,s.a.createElement("strong",{style:{color:"red"}},"Y-axis"),": Number of ducks"),s.a.createElement($.f,{onMouseLeave:function(){return e.setState({value:!1})},width:te-350,height:300,xDomain:[0,24]},s.a.createElement($.d,null),s.a.createElement($.b,null),s.a.createElement($.e,null),s.a.createElement($.g,null),s.a.createElement($.c,r),this.state.value?s.a.createElement($.a,{value:this.state.value}):null))}}]),t}(s.a.Component),le=Object(h.b)(function(e){return e.search.currentSearch?{search:e.search.currentSearch}:{search:[]}})(re),oe=a(73),ce=function(e){var t=e.map(function(e){return e.name}),a=e.map(function(e){return parseFloat(e.total_amount)}),n=a.reduce(function(e,t){return e+t});return{labels:t,datasets:[{label:"What Food: Total ".concat(n," kg"),backgroundColor:"rgba(255,99,132,0.2)",borderColor:"rgba(255,99,132,1)",borderWidth:1,hoverBackgroundColor:"rgba(255,99,132,0.4)",hoverBorderColor:"rgba(255,99,132,1)",data:a}]}},ie=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={data:{}},a.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_.post("feed/list_feed",N.a.stringify(Object(y.a)({},e,{page_disabled:!0,what_food:!0}))).then(function(e){return e.data}).then(function(e){var t=e.list;t.length>0?a.setState({data:ce(t)}):a.setState({data:{}})}).catch(function(e){console.error(e)})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){var t=e.search,a={search_park:JSON.stringify(t.park),search_food:JSON.stringify(t.name),search_kind:JSON.stringify(t.kind)};this.fetchData(a)}},{key:"render",value:function(){var e=this.state.data;return s.a.createElement("div",null,s.a.createElement("h2",null,"What Food"),s.a.createElement(oe.a,{data:e}))}}]),t}(i.Component),se=Object(h.b)(function(e){return e.search.currentSearch?{search:e.search.currentSearch}:{search:[]}})(ie),ue=function(e){var t=e.map(function(e){return e.park}),a=e.map(function(e){return parseFloat(e.total_numbers)}),n=a.reduce(function(e,t){return e+t});return{labels:t,datasets:[{label:"Where: Total ".concat(n," ducks"),backgroundColor:"rgba(155, 89, 182,0.2)",borderColor:"rgba(155, 89, 182,1)",borderWidth:1,hoverBackgroundColor:"rgba(155, 89, 182,0.4)",hoverBorderColor:"rgba(155, 89, 182,1)",data:a}]}},me=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={data:{}},a.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_.post("feed/list_feed",N.a.stringify(Object(y.a)({},e,{page_disabled:!0,where:!0}))).then(function(e){return e.data}).then(function(e){var t=e.list;t.length>0?a.setState({data:ue(t)}):a.setState({data:{}})}).catch(function(e){console.error(e)})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){var t=e.search,a={search_park:JSON.stringify(t.park),search_food:JSON.stringify(t.name),search_kind:JSON.stringify(t.kind)};this.fetchData(a)}},{key:"render",value:function(){var e=this.state.data;return s.a.createElement("div",null,s.a.createElement("h2",null,"What Park"),s.a.createElement(oe.a,{data:e}))}}]),t}(i.Component),de=Object(h.b)(function(e){return e.search.currentSearch?{search:e.search.currentSearch}:{search:[]}})(me),he=function(e){var t=e.map(function(e){return e.what_time}),a=e.map(function(e){return parseFloat(e.total_cnt)}),n=a.reduce(function(e,t){return e+t});return{labels:t,datasets:[{label:"What Time: Total ".concat(n," data points"),backgroundColor:"rgba(52, 152, 219,0.2)",borderColor:"rgba(52, 152, 219,1)",borderWidth:1,hoverBackgroundColor:"rgba(52, 152, 219,0.4)",hoverBorderColor:"rgba(52, 152, 219,1)",data:a}]}},pe=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={data:{}},a.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_.post("feed/list_feed",N.a.stringify(Object(y.a)({},e,{page_disabled:!0,what_time:!0}))).then(function(e){return e.data}).then(function(e){var t=e.list;t.length>0?a.setState({data:he(t)}):a.setState({data:{}})}).catch(function(e){console.error(e)})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){var t=e.search,a={search_park:JSON.stringify(t.park),search_food:JSON.stringify(t.name),search_kind:JSON.stringify(t.kind)};this.fetchData(a)}},{key:"render",value:function(){var e=this.state.data;return s.a.createElement("div",null,s.a.createElement("h2",null,"What Time"),s.a.createElement(oe.a,{data:e}))}}]),t}(i.Component),fe=Object(h.b)(function(e){return e.search.currentSearch?{search:e.search.currentSearch}:{search:[]}})(pe),ge=function(e){var t=e.map(function(e){return e.kind}),a=e.map(function(e){return parseFloat(e.total_amount)}),n=a.reduce(function(e,t){return e+t});return{labels:t,datasets:[{label:"What Kind of Food: Total ".concat(n," kg"),backgroundColor:"rgba(46, 204, 113,0.2)",borderColor:"rgba(46, 204, 113,1)",borderWidth:1,hoverBackgroundColor:"rgba(46, 204, 113,0.4)",hoverBorderColor:"rgba(46, 204, 113,1)",data:a}]}},Ee=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={data:{}},a.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_.post("feed/list_feed",N.a.stringify(Object(y.a)({},e,{page_disabled:!0,kind_food:!0}))).then(function(e){return e.data}).then(function(e){var t=e.list;t.length>0?a.setState({data:ge(t)}):a.setState({data:{}})}).catch(function(e){console.error(e)})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){var t=e.search,a={search_park:JSON.stringify(t.park),search_food:JSON.stringify(t.name),search_kind:JSON.stringify(t.kind)};this.fetchData(a)}},{key:"render",value:function(){var e=this.state.data;return s.a.createElement("div",null,s.a.createElement("h2",null,"What Kind of Food"),s.a.createElement(oe.a,{data:e}))}}]),t}(i.Component),be=Object(h.b)(function(e){return e.search.currentSearch?{search:e.search.currentSearch}:{search:[]}})(Ee),ve=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{style:{marginBottom:"15px",padding:"10px"}},s.a.createElement(d.a,null,s.a.createElement(d.a.Row,null,s.a.createElement(d.a.Column,null,s.a.createElement(I.a,null,s.a.createElement(le,null)))),s.a.createElement(d.a.Row,{columns:2},s.a.createElement(d.a.Column,null,s.a.createElement(I.a,null,s.a.createElement(fe,null))),s.a.createElement(d.a.Column,null,s.a.createElement(I.a,null,s.a.createElement(de,null)))),s.a.createElement(d.a.Row,{columns:2},s.a.createElement(d.a.Column,null,s.a.createElement(I.a,null,s.a.createElement(se,null))),s.a.createElement(d.a.Column,null,s.a.createElement(I.a,null,s.a.createElement(be,null))))))}}]),t}(i.Component),ye=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={park:[],name:[],kind:[],parkOptions:[],foodOptions:[],kindOptions:[]},a.fetchOptionData=function(){_.post("feed/list_all_options").then(function(e){return e.data}).then(function(e){var t=e.error_code,n=e.option_park,r=e.option_food,l=e.option_kind;"Authorization Error"!==t&&a.setState({parkOptions:n.map(function(e){return{key:e.id,value:e.park,text:e.park}}),foodOptions:r.map(function(e){return{key:e.id,value:e.name,text:e.name}}),kindOptions:l.map(function(e){return{key:e.id,value:e.kind,text:e.kind}})})}).catch(function(e){console.error(e)})},a.handleParkChange=function(e,t){var n=t.value;a.setState({park:n},function(){return a.props.doSearch(a.state)})},a.handleFoodChange=function(e,t){var n=t.value;a.setState({name:n},function(){return a.props.doSearch(a.state)})},a.handleKindChange=function(e,t){var n=t.value;a.setState({kind:n},function(){return a.props.doSearch(a.state)})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fetchOptionData()}},{key:"componentWillReceiveProps",value:function(e){var t=e.search;Array.isArray(t)&&0===t.length&&(this.setState({park:[],name:[],kind:[]}),this.fetchOptionData())}},{key:"render",value:function(){var e=this.state,t=e.park,a=e.name,n=e.kind,r=e.parkOptions,l=e.foodOptions,o=e.kindOptions;return s.a.createElement("div",{className:"search"},s.a.createElement(I.a,null,s.a.createElement("h2",null,"Search"),s.a.createElement(d.a,{columns:"equal"},s.a.createElement(d.a.Row,null,s.a.createElement(d.a.Column,null,s.a.createElement(E.a,{placeholder:"Park",fluid:!0,multiple:!0,search:!0,selection:!0,options:r,value:t,onChange:this.handleParkChange})),s.a.createElement(d.a.Column,null,s.a.createElement(E.a,{placeholder:"Name of Food",fluid:!0,multiple:!0,search:!0,selection:!0,options:l,value:a,onChange:this.handleFoodChange})),s.a.createElement(d.a.Column,null,s.a.createElement(E.a,{placeholder:"Kind of Food",fluid:!0,multiple:!0,search:!0,selection:!0,options:o,value:n,onChange:this.handleKindChange}))))))}}]),t}(i.Component),ke=Object(h.b)(function(e){return e.search.currentSearch?{search:e.search.currentSearch}:{search:[]}},{doSearch:k})(ye),Ce=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(ke,null),s.a.createElement(ve,null),s.a.createElement(X,{currentUser:this.props.currentUser}))}}]),t}(i.Component),Oe=Object(h.b)(function(e){return{currentUser:e.user.currentUser}})(function(e){var t=e.currentUser;return s.a.createElement(d.a,{columns:"equal",className:"app",style:{background:"#eee"}},s.a.createElement(K,{key:t&&t.id,currentUser:t}),s.a.createElement(d.a.Column,{style:{marginLeft:250}},s.a.createElement(Ce,{currentUser:t})))}),Se=a(661),je=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={email:"",password:"",errors:[],loading:!1},a.displayErrors=function(e){return e.map(function(e,t){return s.a.createElement("p",{key:t},e.message)})},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.isFormValid()&&(a.setState({errors:[],loading:!0}),_.post("users/login",N.a.stringify({email:a.state.email,password:a.state.password})).then(function(e){return e.data}).then(function(e){if(e.error_code){console.error(e.error_code);var t={message:e.error_code.join()};a.setState({errors:a.state.errors.concat(t),loading:!1})}else console.log("login succeed"),localStorage.setItem("ACCESS_TOKEN",e.token),_.defaults.headers.common.Authorization=e.token,a.setState({loading:!1}),a.props.setUser(e.user),a.props.history.push("/")}).catch(function(e){console.error(e),a.setState({errors:a.state.errors.concat(e),loading:!1})}))},a.isFormValid=function(){var e;return!a.isFormEmpty(a.state)||(e={message:"Fill in all fields"},a.setState({errors:[].concat(e)}),!1)},a.isFormEmpty=function(e){var t=e.email,a=e.password;return!t.length||!a.length},a.handleInputError=function(e,t){return e.some(function(e){return e.message.toLowerCase().includes(t)})?"error":""},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password,n=e.errors,r=e.loading;return s.a.createElement(d.a,{textAlign:"center",verticalAlign:"middle",className:"app"},s.a.createElement(d.a.Column,{style:{maxWidth:450}},s.a.createElement(f.a,{as:"h2",icon:!0,color:"yellow",textAlign:"center"},s.a.createElement(g.a,{name:"paw",color:"yellow"}),"Login to DuckFeed"),s.a.createElement(F.a,{size:"large",onSubmit:this.handleSubmit},s.a.createElement(I.a,{stacked:!0},s.a.createElement(F.a.Input,{fluid:!0,name:"email",icon:"mail",iconPosition:"left",className:this.handleInputError(n,"email"),placeholder:"Email Address",onChange:this.handleChange,value:t,type:"email"}),s.a.createElement(F.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",className:this.handleInputError(n,"password"),placeholder:"Password",onChange:this.handleChange,value:a,type:"password"}),s.a.createElement(x.a,{color:"yellow",fluid:!0,size:"large",disabled:r,className:r?"loading":""},"Submit"))),n.length>0&&s.a.createElement(U.a,{error:!0},s.a.createElement("h3",null,"Error"),this.displayErrors(n)),s.a.createElement(U.a,null,"Don't have an account? ",s.a.createElement(Se.a,{to:"/register"},"Register"))))}}]),t}(i.Component),we=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={name:"",email:"",password:"",passwordConfirmation:"",errors:[],loading:!1},a.isFormValid=function(){var e,t=[];return a.isFormEmpty(a.state)?(e={message:"Fill in all fields"},a.setState({errors:t.concat(e)}),!1):!!a.isPasswordValid(a.state)||(e={message:"Password is invalid"},void a.setState({errors:t.concat(e)}))},a.isFormEmpty=function(e){var t=e.name,a=e.email,n=e.password,r=e.passwordConfirmation;return!t.length||!a.length||!n.length||!r.length},a.isPasswordValid=function(e){var t=e.password,a=e.passwordConfirmation;return!(t.length<6||a.length<6)&&t===a},a.displayErrors=function(e){return e.map(function(e,t){return s.a.createElement("p",{key:t},e.message)})},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.isFormValid()&&(a.setState({errors:[],loading:!0}),_.post("users/signup",N.a.stringify({name:a.state.name,email:a.state.email,password:a.state.password})).then(function(e){return e.data}).then(function(e){if(e.error_code){console.error(e.error_code);var t={message:e.error_code.join()};a.setState({errors:a.state.errors.concat(t),loading:!1})}else localStorage.setItem("ACCESS_TOKEN",e.token),_.defaults.headers.common.Authorization=e.token,a.setState({loading:!1}),a.props.setUser(e.user),a.props.history.push("/")}).catch(function(e){console.error(e),a.setState({errors:a.state.errors.concat(e),loading:!1})}))},a.handleInputError=function(e,t){return e.some(function(e){return e.message.toLowerCase().includes(t)})?"error":""},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.email,n=e.password,r=e.passwordConfirmation,l=e.errors,o=e.loading;return s.a.createElement(d.a,{textAlign:"center",verticalAlign:"middle",className:"app"},s.a.createElement(d.a.Column,{style:{maxWidth:450}},s.a.createElement(f.a,{as:"h2",icon:!0,color:"orange",textAlign:"center"},s.a.createElement(g.a,{name:"paw",color:"orange"}),"Register for DuckFeed"),s.a.createElement(F.a,{size:"large",onSubmit:this.handleSubmit},s.a.createElement(I.a,{stacked:!0},s.a.createElement(F.a.Input,{fluid:!0,name:"name",icon:"user",iconPosition:"left",placeholder:"Username",onChange:this.handleChange,value:t,type:"text"}),s.a.createElement(F.a.Input,{fluid:!0,name:"email",icon:"mail",iconPosition:"left",className:this.handleInputError(l,"email"),placeholder:"Email Address",onChange:this.handleChange,value:a,type:"email"}),s.a.createElement(F.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",className:this.handleInputError(l,"password"),placeholder:"Password",onChange:this.handleChange,value:n,type:"password"}),s.a.createElement(F.a.Input,{fluid:!0,name:"passwordConfirmation",icon:"repeat",iconPosition:"left",className:this.handleInputError(l,"password"),placeholder:"Password Confirmation",onChange:this.handleChange,value:r,type:"password"}),s.a.createElement(x.a,{color:"orange",fluid:!0,size:"large",disabled:o,className:o?"loading":""},"Submit"))),l.length>0&&s.a.createElement(U.a,{error:!0},s.a.createElement("h3",null,"Error"),this.displayErrors(l)),s.a.createElement(U.a,null,"Already a user? ",s.a.createElement(Se.a,{to:"/login"},"Login"))))}}]),t}(i.Component),_e=function(){return s.a.createElement(z.a,{active:!0},s.a.createElement(V.a,{size:"huge",content:"Preparing..."}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var De=a(664),Ne=a(662),Ae=a(665),Fe=a(663),Pe=(a(654),a(657),a(87)),Re=a(388),Ie={currentUser:null,isLoading:!0},Te={park:[],name:[],kind:[]},Ue=Object(Pe.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return{currentUser:t.payload.currentUser,loading:!1};case"CLEAR_USER":return Object(y.a)({},e,{isLoading:!1});default:return e}},search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DO_SEARCH":return{currentSearch:t.payload.currentSearch};default:return e}}}),xe=Object(Pe.createStore)(Ue,Object(Re.composeWithDevTools)()),Me=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).componentDidMount=function(){var e=localStorage.getItem("ACCESS_TOKEN");e?_.post("users/check_token",N.a.stringify({token:e})).then(function(e){return e.data}).then(function(e){console.log(e),e.valid?(console.log("user valid"),a.props.setUser(e.user),a.props.history.push("/")):(a.props.history.push("/login"),localStorage.setItem("ACCESS_TOKEN",""),a.props.clearUser())}):(a.props.history.push("/login"),localStorage.setItem("ACCESS_TOKEN",""),a.props.clearUser())},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return this.props.isLoading?s.a.createElement(_e,null):s.a.createElement(De.a,null,s.a.createElement(Ne.a,{exact:!0,path:"/",component:Oe}),s.a.createElement(Ne.a,{path:"/login",render:function(t){return s.a.createElement(je,Object.assign({},t,{setUser:e.props.setUser}))}}),s.a.createElement(Ne.a,{path:"/register",render:function(t){return s.a.createElement(we,Object.assign({},t,{setUser:e.props.setUser}))}}))}}]),t}(s.a.Component),We=Object(Ae.a)(Object(h.b)(function(e){return{isLoading:e.user.isLoading}},{setUser:function(e){return{type:"SET_USER",payload:{currentUser:e}}},clearUser:function(){return{type:"CLEAR_USER"}}})(Me));m.a.render(s.a.createElement(h.a,{store:xe},s.a.createElement(Fe.a,null,s.a.createElement(We,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[395,2,1]]]);
//# sourceMappingURL=main.b2faaed6.chunk.js.map